<p align="center">
    <img
    src="./shorkie_logo.png"
    alt="Shorkie logo"
    style="display:block; margin-inline:auto; width:30%; height:auto;"
    />
</p>

# Shorkie - Predicting dynamic expression patterns in budding yeast with a fungal DNA language model

Shorkie is a semi-supervised sequence-to-expression model for yeast: a masked DNA language model pretrained on hundreds of closely related fungal genomes and fine-tuned on thousands of epigenomic and transcriptomic profiles—including a large set of transcriptional-regulator induction RNA-seq experiments generated for this study—to predict RNA-seq coverage and variant effects.


This repository contains shell scripts, notebooks, and command snippets used to reproduce the analyses in the **Shorkie** paper. These analyses invoke functionality from the <a href="https://github.com/calico/baskerville-yeast" target="_blank"><strong>baskerville-yeast</strong></a>, and <a href="https://github.com/calico/westminster" target="_blank"><strong>westminster</strong></a> repositories. Please visit those repositories for installation and environment setup instructions.

Contact *drk (at) @calicolabs.com*, *jlinder (at) @calicolabs.com*, or *kuanhao.chao (at) @gmail.com* for questions.

## Model Availability

The model weights can be downloaded as .h5 files from the URLs below. We are releasing both Shorkie LM-DNA language model and Shorkie, fine-tuned with thousands of epigenomic and transcriptomic profiles. 

[Shorkie LM](gs://calico-khc-transfer/shorkie_models/Shorkie_LM/)
[Shorkie](gs://calico-khc-transfer/shorkie_models/shorkie/)


## Data Availability

### Shorkie LM

The genomes used for self-supervised language-model pretraining are at gs://shorkie-paper/data/unsupervised/genome/, with corresponding TFRecords at gs://shorkie-paper/data/unsupervised/processed/.

### Shorkie
The new Induction Dynamics Gene Expression Atlas RNA-seq datasets generated by Calico Life Sci-
ences LLC are hosted on Google Cloud Storage (GCS). Coverage tracks (BigWig) are available at
gs://shorkie-paper/data/supervised/bigwigs/, and processed TFRecords are at gs://shorkie-paper/data/supervised/processed.

## Benchmark data availability

### eQTL data availability

### MPRA data availability


## Example Notebook