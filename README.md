<p align="center">
    <img
    src="./shorkie_logo.png"
    alt="Shorkie logo"
    style="display:block; margin-inline:auto; width:30%; height:auto;"
    />
</p>

# Shorkie - Predicting dynamic expression patterns in budding yeast with a fungal DNA language model

Shorkie is a semi-supervised sequence-to-expression model for yeast: a masked DNA language model pretrained on hundreds of closely related fungal genomes and fine-tuned on thousands of epigenomic and transcriptomic profiles—including a large set of transcriptional-regulator induction RNA-seq experiments generated for this study—to predict RNA-seq coverage and variant effects.


This repository contains shell scripts, notebooks, and command snippets used to reproduce the analyses in the **Shorkie** paper. These analyses invoke functionality from the <a href="https://github.com/calico/baskerville-yeast" target="_blank"><strong>baskerville-yeast</strong></a>, and <a href="https://github.com/calico/westminster" target="_blank"><strong>westminster</strong></a> repositories. Please visit those repositories for installation and environment setup instructions.

Contact *drk (at) @calicolabs.com*, *jlinder (at) @calicolabs.com*, or *kuanhao.chao (at) @gmail.com* for questions.

## Model Availability

The model weights can be downloaded as .h5 files from the URLs below. We are releasing both Shorkie LM-DNA language model and Shorkie, fine-tuned with thousands of epigenomic and transcriptomic profiles. 

- [Shorkie LM](https://storage.googleapis.com/seqnn-share/shorkie_lm/train/model_best.h5)
- [Shorkie](https://storage.googleapis.com/seqnn-share/shorkie)
    - [f0](https://storage.googleapis.com/seqnn-share/shorkie/f0/model_best.h5) | [f1](https://storage.googleapis.com/seqnn-share/shorkie/f1/model_best.h5) | [f2](https://storage.googleapis.com/seqnn-share/shorkie/f2/model_best.h5) | [f3](https://storage.googleapis.com/seqnn-share/shorkie/f3/model_best.h5) | [f4](https://storage.googleapis.com/seqnn-share/shorkie/f4/model_best.h5) | [f5](https://storage.googleapis.com/seqnn-share/shorkie/f5/model_best.h5) | [f6](https://storage.googleapis.com/seqnn-share/shorkie/f6/model_best.h5) | [f7](https://storage.googleapis.com/seqnn-share/shorkie/f7/model_best.h5)


## Data Availability

### Shorkie LM

Shorkie LM (the primary model) was pretrained on the **165_Saccharomycetales** corpus.  
To support reproducibility and the Shorkie LM variants introduced in the paper, we also release three companion corpora—**R64**, **80_strains**, and **1341_Fungus**—each with raw genomes and matched TFRecords. These corpora span different phylogenetic distances and were used to train additional DNA language model variants.
    - R64: [genomes](https://storage.googleapis.com/shorkie-paper/data/unsupervised/genome/R64/) | [tfrecord](https://storage.googleapis.com/shorkie-paper/data/unsupervised/processed/R64/)
    - 80_strains: [genomes](https://storage.googleapis.com/shorkie-paper/data/unsupervised/genome/80_strains/) | [tfrecord](https://storage.googleapis.com/shorkie-paper/data/unsupervised/processed/80_strains/)
    - 165_Saccharomycetales: [genomes](https://storage.googleapis.com/shorkie-paper/data/unsupervised/genome/165_Saccharomycetales/) | [tfrecord](https://storage.googleapis.com/shorkie-paper/data/unsupervised/processed/165_Saccharomycetales/)
    - 1341_Fungus: [genomes](https://storage.googleapis.com/shorkie-paper/data/unsupervised/genome/1341_Fungus/) | [tfrecord](https://storage.googleapis.com/shorkie-paper/data/unsupervised/processed/1341_Fungus/)


### Shorkie

Shorkie was fine-tuned on large-scale transcriptomic and epigenomic datasets in *S. cerevisiae*:

- **Induction Dynamics Gene Expression Atlas (IDEA)**: 3,053 RNA-seq **induction time-point** samples from the *Induction Dynamics Gene Expression Atlas (IDEA)*. New datasets generated by Calico Life Sciences LLC (related to IDEA 1.0; Hackett, S.R. et al., *Mol Syst Biol*, 2020).  
  • [Coverage tracks (BigWig)](https://storage.googleapis.com/shorkie-paper/data/supervised/bigwigs/)
  • [Processed TFRecords](https://storage.googleapis.com/shorkie-paper/data/supervised/processed/)

- **Yeast strain RNA-seq**: 1,014 RNA-seq datasets across diverse *S. cerevisiae* strains (Caudal, É. et al., *Nat Genet*, 2024).

- **ChIP-exo** & **ChIP-MNase**: 1,128 + 20 tracks (Rossi, M.J. et al., *Nature*, 2021).

## Benchmark data availability

### eQTL data availability

### MPRA data availability


## Example Notebook