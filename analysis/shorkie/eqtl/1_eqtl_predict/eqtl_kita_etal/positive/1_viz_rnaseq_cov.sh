#!/bin/bash

#SBATCH --time=48:00:00
#SBATCH -N 1
#SBATCH -n 8
#SBATCH --job-name=viz_ism_shorkie
#SBATCH --output=job_output_%A_%a.log
#SBATCH --mail-type=end
#SBATCH --mail-user=kuanhao.chao@gmail.com
#SBATCH --mem=12G
#SBATCH --array=0-700
# 
GENES=(YOR319W YLR044C YHR135C YBR204C YBR204C YJL094C YJL004C YBR236C YKR005C YBR039W YER151C YDR349C YIR005W YNL294C YPL002C YGL057C YLR046C YOR038C YER105C YOR180C YBR157C YLR132C YML086C YPR141C YCR020W-B YCR020C YCR020C-A YMR267W YMR267W YMR267W YJL011C YBL019W YGL197W YHR097C YHR102W YOR335C YOR261C YKL217W YDR111C YGL128C YGL170C YLR116W YPL180W YJL199C YFR024C-A YER186C YER186C YER186C YDL170W YOR005C YNL119W YOR286W YPR135W YEL069C YKR052C YER176W YDR197W YDL055C YHR075C YGR257C YKL094W YKL095W YKL094W YKL095W YGR167W YFR032C-A YML118W YMR259C YDR182W-A YJR036C YDR520C YOL060C YMR151W YHR091C YKR060W YLR168C YDL089W YKL084W YOL122C YGR286C YHL031C YER019C-A YPR018W YBR148W YKR050W YBR055C YBR055C YDL057W YPL092W YOR179C YOR179C YFL052W YLR165C YLR165C YDR415C YDR415C YAR023C YGL203C YLR037C YOR030W YAR028W YKR091W YKL096W YBR296C YLR096W YOR222W YGL214W YDR498C YMR253C YLR015W YEL064C YNR017W YDR233C YDR233C YDR233C YDR233C YDR233C YDR233C YLR006C YBR170C YNL239W YOL024W YOL024W YLR399C YOR154W YBL013W YKL088W YPR194C YJR093C YMR315W-A YNL051W YJL181W YCR063W YHR161C YJL160C YJL160C YJL160C YMR132C YGR246C YAL042W YBR290W YDL201W YDR100W YAL061W YAL061W YAL061W YPR064W YPR065W YLR238W YBR103C-A YER056C YBR146W YBR166C YDR189W YMR260C YCR077C YHR022C-A YHR022C-A YHR022C-A YHR022C-A YHR022C-A YHR022C-A YNL050C YJL178C YKR024C YIR021W YGR137W YPL062W YLR389C YDL199C YPL103C YPL103C YJR019C YMR023C YEL043W YPL088W YEL038W YMR086C-A YDR411C YPR147C YJL083W YOR140W YKR070W YLL007C YNL201C YKL206C YNL123W YNL117W YOR168W YJR015W YDR122W YDL160C YDR317W YKR022C YKR022C YDL094C YOR318C YJR147W YGR121C YOR266W YLR244C YLR188W YJR006W YJR006W YGR113W YMR092C YMR278W YGL219C YNR012W YNR012W YDR237W YLR034C YPL017C YDL216C YLR376C YGR001C YDR262W YLR395C YGL056C YOR209C YDR275W YOR075W YNL128W YKL013C YER072W YIL067C YMR288W YER175W-A YGL154C YGL154C YDL236W YBR298C YMR291W YMR128W YOL027C YHR140W YOR186W YOL007C YLR145W YHR047C YGR225W YOL050C YBR241C YFR022W YDL209C YJR024C YHR046C YGL108C YDR339C YJL036W YER100W YOL065C YKL210W YNL087W YKL086W YPL038W YAL002W YMR180C YCL033C YNL061W YJR104C YLR083C YDR243C YCR057C YNL072W YJR088C YLR032W YLL060C YJL089W YLR173W YBL006C YBL079W YER110C YER110C YER110C YER110C YOL092W YOL091W YOR285W YOR285W YOR285W YOR285W YKR087C YMR126C YCL057C-A YAL059W YJR078W YML065W YML065W YJL057C YDR354W YPL156C YOR342C YNL181W YPR010C-A YDR106W YFL024C YGR093W YGR093W YGR093W YGR093W YGR093W YNR061C YNR061C YNR061C YNR061C YMR097C YDR388W YCR095W-A YCR095W-A YBR254C YPL091W YMR054W YNL316C YHR187W YNL095C YKR017C YLR398C YMR261C YMR262W YPL245W YOL066C YLR288C YOR308C YGR111W YOR112W YCR052W YBL078C YLR117C YEL035C YEL035C YEL035C YEL035C YEL035C YPR095C YBL063W YEL052W YJR010C-A YLR417W YLR367W YDR527W YLR045C YDR037W YOL023W YJL216C YNL080C YDL046W YEL021W YEL021W YHR007C YOR229W YPL046C YHR208W YHR120W YDR487C YMR006C YDL095W YDR311W YML099C YML099C YER114C YHR155W YDR436W YGR016W YKL020C YJR106W YJR106W YJR106W YJR106W YML030W YOR028C YHR058C YMR152W YPL038W-A YOR323C YJL066C YCL026C-B YJL070C YLL001W YNL133C YKL144C YKL178C YOR132W YOR371C YCL026C-A YOL133W YHR069C YHR069C YHR069C YHR069C YHR115C YIR014W YGR233C YBR094W YHR031C YKL167C YOR149C YHR205W YGR287C YGR287C YBL025W YDR089W YBR280C YOR316C YDL125C YLR151C YPL071C YHR013C YGL140C YGR288W YCR006C YBR109C YGL169W YBR163W YJR118C YCL034W YLR139C YLR139C YMR133W YJL076W YJL076W YER007W YML058W YOR196C YNL159C YCR107W YER163C YOR294W YIL140W YAL049C YOL104C YEL028W YDR329C YHR022C YPL168W YPL174C YPL174C YPL174C YDR132C YGR179C YHR024C YBR297W YOR201C YLR126C YDR341C YMR256C YMR124W YDL130W-A YOL083W YOL083W YOL083W YOL083W YAL062W YIL111W YIL111W YIL111W YBR060C YNL263C YDR496C YPR071W YLR424W YLR219W YOL017W YOL017W YFL026W YOR175C YPL117C YLR121C YML080W YML080W YEL019C YML011C YGR081C YOR348C YMR201C YMR201C YMR201C YMR201C YMR201C YMR201C YKR051W YHL038C YDR370C YDR370C YIL028W YDR287W YGL136C YOR021C YJL164C YDR338C YKL081W YLR056W YDR478W YDR255C YLR179C YAR042W YER049W YOR249C YNL193W YDR365C YKL017C YMR266W YBR256C YDR419W YOR278W YGR104C YPL138C YBR230W-A YPL256C YPL007C YPL007C YGL093W YBR209W YKL119C YKL119C YKL119C YKL119C YKL119C YKL119C YKL119C YKL119C YNR008W YMR320W YMR320W YMR320W YDR439W YDR353W YDR276C YMR119W-A YDR185C YNL265C YMR099C YMR099C YER008C YKL218C YHR065C YNL215W YGR256W YJL215C YMR058W YPR069C YDR240C YGR059W YGR046W YGR102C YGR130C YJL025W YPL124W YCL049C YNR044W YKL110C YNR039C YDL073W YLL056C YHR105W YKL185W YBR117C YLR150W YGR161W-C YOR362C YHR112C YHR112C YNL163C YMR014W YPL107W YOR228C YLR176C YNL063W YGR002C YML116W YLR372W YIL050W YML028W YJL127C YBR147W YGR012W YMR127C YPL008W YHR012W YNL280C YBR074W YLR215C YMR068W YMR110C YKR078W YJR005W YOL146W YFL046W YJR100C YDL157C YLR036C YDR320C YML061C YMR063W YGL155W YJL147C YER004W YPR152C YOR052C YDL002C YOR305W YJL097W YJL145W YMR112C YMR112C YMR112C YLL043W YGL150C YNL002C YBR295W YHL048W YLR283W YER086W YOR138C YJR151C YBR142W YBR142W YBR142W YBR142W YBR142W YBR142W YBR142W YBR142W YJR032W YHR045W YJL163C YGR280C YNL268W YHL040C YHL040C YDR423C YHR111W YHR111W YOL137W YOL137W YOL144W YNL321W YKL035W YLR412W YDL135C YBR278W YPL014W YPL014W YAL058W YDR463W YPL212C YAR008W YAR027W YLR325C YGL067W YGL174W YGL174W YGR089W YPL200W YCR083W YDR113C YDR514C YHR034C YKL162C-A YFL020C YLR431C YOR350C YHR035W YGR117C YBR193C YIL155C YDL037C YDL045W-A YMR161W YHL041W YLR290C YBR197C YOR080W YOR113W YMR211W YLL026W)
CENTER_POS=(912729 233839 373666 633358 633618 254157 431895 691543 449253 316657 472453 1172380 365355 78731 554350 395803 239098 403351 368857 675191 553726 407639 97600 815624 155181 155181 155181 801732 801754 801808 414241 184372 124719 298009 319904 948744 816109 22120 679489 270346 184145 381556 205903 60299 203342 561555 561578 561590 156313 336579 401498 850723 801066 22506 532537 541650 851220 356055 248390 1006307 262728 262728 263612 263612 832207 223266 33836 788974 829122 503860 1481898 213920 562796 285807 557093 500491 297638 280459 91324 1065212 38887 194678 594886 537535 527886 346855 346898 351322 374470 672226 672492 28759 494448 495378 1297994 1298024 179961 112455 222808 387926 185031 611432 261007 797056 332650 758295 90010 1446900 776860 175306 30054 662586 930017 930091 930330 930469 930727 930856 162922 577418 200328 277027 277036 920063 624558 202108 275352 925048 604040 904245 532670 86690 228849 422538 118832 118865 118943 535752 984464 62565 782686 100361 655473 33113 33140 33237 679524 679524 614915 449325 268009 535096 571349 840497 789347 250253 150659 150760 150824 150894 151012 151069 534949 90197 485189 398401 762575 431986 901179 103365 358804 358908 468418 321097 72214 381894 80541 442194 1293708 826518 281003 589621 574704 134269 263592 49741 394591 406337 649484 463134 697612 170455 1103168 482531 482546 289558 911784 705421 733088 822301 626422 528722 449051 449239 720097 453647 824628 84203 648754 648982 937331 212271 520069 68911 873624 497747 993336 909639 396452 737960 1012145 468739 382763 417408 303277 236267 848240 541065 215800 215891 32904 804327 852469 524205 273137 380512 683295 312245 432798 199736 945155 238200 704181 196793 86474 470737 198508 303497 1150352 379298 359471 205799 42198 462234 278179 480795 144848 622608 62729 510472 623040 294066 950307 220575 490203 586368 206056 21252 268178 502281 216623 76157 379065 379497 380132 381237 145140 145140 849171 849618 850507 851026 604356 522074 23930 37199 579361 142236 142365 330212 1185226 256995 966892 298243 582788 667780 87759 670712 670773 670987 671032 671997 742656 742699 742721 742802 459754 1251737 290645 290657 723949 375375 383031 42326 482017 446017 473531 916308 793604 793604 85843 203557 714966 896125 715746 533280 216257 80838 384681 82885 86451 87182 87617 87749 721892 105289 58103 458269 954897 855713 1491574 235709 526669 278631 24926 478376 371461 115890 115997 122014 769889 467054 518542 349648 1428277 278376 287170 1086726 75886 75934 391130 409115 1336950 522948 401769 625386 625908 627747 627840 216327 383383 219735 562955 480296 922567 313925 74146 310841 147929 374798 175807 113078 574049 1033684 75503 71038 234504 234904 234919 235033 341383 381696 956182 431912 173207 134200 609550 511687 1067267 1067366 172346 622044 764849 906271 239907 441632 420405 130783 242766 1070404 122914 458104 185905 565832 643441 61630 420648 422273 536887 296279 296312 165294 159850 716951 338424 314321 503447 868096 86076 52733 116543 99132 1127676 149305 231052 220050 220276 220547 718867 854998 158014 800837 720674 394740 1152643 778814 517233 229260 165725 165776 165953 165998 31821 155025 155079 155378 362082 148156 1443444 689251 973725 573942 294636 294882 83639 659697 328317 388891 108675 109687 120900 246910 643888 988183 666234 666239 666761 667143 667280 667285 531524 25276 1218917 1218963 301691 1035801 253849 373586 111445 1148453 284656 254691 1414676 966626 514845 195324 251756 800594 275211 1206428 407067 798847 727755 1304837 843670 698252 292638 680638 64913 543909 544071 334704 642492 216419 217027 218507 218608 219505 220145 220341 220848 641859 915419 915971 916196 1339402 1183281 1013882 506838 832353 145101 465031 465036 171549 17206 229142 244308 1006061 26695 388986 685648 945256 607810 584683 694466 753494 395232 317528 40144 705221 230092 699116 326798 28711 324502 94985 475985 441099 810738 1018000 335817 335859 327287 298712 349012 768052 508529 507790 499486 38072 868454 259877 220596 181967 537018 513253 523523 539281 129665 110629 386919 571751 406333 491360 586172 447815 48688 42955 617418 174131 221376 1106326 151715 398904 214473 142013 159475 833312 427159 447337 889642 245436 145879 494172 494475 494673 51267 222441 626122 792788 7338 705191 330290 585728 712663 525840 525957 526918 527051 527779 527850 528195 531340 492295 195679 113461 1051899 139398 20795 20852 1318821 334370 334394 65658 68575 52864 35786 371007 949229 219175 760258 527254 527706 38689 1387061 151407 159469 184204 780981 375972 174394 174818 657229 171982 259496 680813 1472819 178061 145744 99259 1001139 994833 178242 725111 609255 53860 385750 372564 578498 17359 717712 615698 474477 536881 689061 90764)
POS=(912729 233839 373666 633358 633618 254157 431895 691543 449253 316657 472453 1172380 365355 78731 554350 395803 239098 403351 368857 675191 553726 407639 97600 815624 155181 155181 155181 801732 801754 801808 414241 184372 124719 298009 319904 948744 816109 22120 679489 270346 184145 381556 205903 60299 203342 561555 561578 561590 156313 336579 401498 850723 801066 22506 532537 541650 851220 356055 248390 1006307 262728 262728 263612 263612 832207 223266 33836 788974 829122 503860 1481898 213920 562796 285807 557093 500491 297638 280459 91324 1065212 38887 194678 594886 537535 527886 346855 346898 351322 374470 672226 672492 28759 494448 495378 1297994 1298024 179961 112455 222808 387926 185031 611432 261007 797056 332650 758295 90010 1446900 776860 175306 30054 662586 930017 930091 930330 930469 930727 930856 162922 577418 200328 277027 277036 920063 624558 202108 275352 925048 604040 904245 532670 86690 228849 422538 118832 118865 118943 535752 984464 62565 782686 100361 655473 33113 33140 33237 679524 679524 614915 449325 268009 535096 571349 840497 789347 250253 150659 150760 150824 150894 151012 151069 534949 90197 485189 398401 762575 431986 901179 103365 358804 358908 468418 321097 72214 381894 80541 442194 1293708 826518 281003 589621 574704 134269 263592 49741 394591 406337 649484 463134 697612 170455 1103168 482531 482546 289558 911784 705421 733088 822301 626422 528722 449051 449239 720097 453647 824628 84203 648754 648982 937331 212271 520069 68911 873624 497747 993336 909639 396452 737960 1012145 468739 382763 417408 303277 236267 848240 541065 215800 215891 32904 804327 852469 524205 273137 380512 683295 312245 432798 199736 945155 238200 704181 196793 86474 470737 198508 303497 1150352 379298 359471 205799 42198 462234 278179 480795 144848 622608 62729 510472 623040 294066 950307 220575 490203 586368 206056 21252 268178 502281 216623 76157 379065 379497 380132 381237 145140 145140 849171 849618 850507 851026 604356 522074 23930 37199 579361 142236 142365 330212 1185226 256995 966892 298243 582788 667780 87759 670712 670773 670987 671032 671997 742656 742699 742721 742802 459754 1251737 290645 290657 723949 375375 383031 42326 482017 446017 473531 916308 793604 793604 85843 203557 714966 896125 715746 533280 216257 80838 384681 82885 86451 87182 87617 87749 721892 105289 58103 458269 954897 855713 1491574 235709 526669 278631 24926 478376 371461 115890 115997 122014 769889 467054 518542 349648 1428277 278376 287170 1086726 75886 75934 391130 409115 1336950 522948 401769 625386 625908 627747 627840 216327 383383 219735 562955 480296 922567 313925 74146 310841 147929 374798 175807 113078 574049 1033684 75503 71038 234504 234904 234919 235033 341383 381696 956182 431912 173207 134200 609550 511687 1067267 1067366 172346 622044 764849 906271 239907 441632 420405 130783 242766 1070404 122914 458104 185905 565832 643441 61630 420648 422273 536887 296279 296312 165294 159850 716951 338424 314321 503447 868096 86076 52733 116543 99132 1127676 149305 231052 220050 220276 220547 718867 854998 158014 800837 720674 394740 1152643 778814 517233 229260 165725 165776 165953 165998 31821 155025 155079 155378 362082 148156 1443444 689251 973725 573942 294636 294882 83639 659697 328317 388891 108675 109687 120900 246910 643888 988183 666234 666239 666761 667143 667280 667285 531524 25276 1218917 1218963 301691 1035801 253849 373586 111445 1148453 284656 254691 1414676 966626 514845 195324 251756 800594 275211 1206428 407067 798847 727755 1304837 843670 698252 292638 680638 64913 543909 544071 334704 642492 216419 217027 218507 218608 219505 220145 220341 220848 641859 915419 915971 916196 1339402 1183281 1013882 506838 832353 145101 465031 465036 171549 17206 229142 244308 1006061 26695 388986 685648 945256 607810 584683 694466 753494 395232 317528 40144 705221 230092 699116 326798 28711 324502 94985 475985 441099 810738 1018000 335817 335859 327287 298712 349012 768052 508529 507790 499486 38072 868454 259877 220596 181967 537018 513253 523523 539281 129665 110629 386919 571751 406333 491360 586172 447815 48688 42955 617418 174131 221376 1106326 151715 398904 214473 142013 159475 833312 427159 447337 889642 245436 145879 494172 494475 494673 51267 222441 626122 792788 7338 705191 330290 585728 712663 525840 525957 526918 527051 527779 527850 528195 531340 492295 195679 113461 1051899 139398 20795 20852 1318821 334370 334394 65658 68575 52864 35786 371007 949229 219175 760258 527254 527706 38689 1387061 151407 159469 184204 780981 375972 174394 174818 657229 171982 259496 680813 1472819 178061 145744 99259 1001139 994833 178242 725111 609255 53860 385750 372564 578498 17359 717712 615698 474477 536881 689061 90764)
ALTS=(T G A C C A A C G G A G T T A A G C G C A G A T G G G A A A C T G C T G T G T G A A A T T C T A A C A G A A A A G A T T G G C C A G A G C C G C C C C G C C G A C G A A A T C T T T A G A G A C T T G C G A C C A G G T G G C G C A T A C C A C A C T T T T C A A T A T C A A C A A T A C G G A A A G G G C A T G A A A C T A C G C T C A C T T T T C A T T C A C G A T C G A A T T A A A G C C T A A C C C T G A T T A A A C C A A A G A C G A T A G G T T G A A T G T T T A T C C T C G C G T G C T C A T G C C T A T T T T C C A G G C T C G A G G C C A T C A A T C C C T G T T G T C C T A C G T C G A T C G G C T A G A G A T G A T C A A G A G A T A A A G C C A C G T T G C T G T G A G A G G T A T C C C T C A C C C T G G C C G T C A C C T G G A A T A A G T C A G C G T T T T A G T T C A T T A T G T T G T A G A A T C T C T C G C G A T A T T C G A C C G T A C C A T A C A A G G C T C T A C G G A T C T C T G C C G A G T T C A T G G C A G G G G G A T A G T T A A G T A G G T T A T G G C G C T A C G G A C T A A C T G T A G C G T A G A C C G C A T G G C C C A A G T C G C C T T A A G A C A A G G C G T G T A A G T A A T T T T T T T C A T T C G G C A G C T C A A C T G T G T G A C A A A G T G A A G T G C C C A T T A C C G A T T T A G G G A A C A T G G G A T T T T G C G A T A C C A G T C T A A A C T A C C C C A G C G G A T C G A G C A G C G C T C C G C T G A A T T A)

CONDITION="test"
OUTDIR="results"

# Pick the ith entry based on SLURM_ARRAY_TASK_ID
IDX=$SLURM_ARRAY_TASK_ID
GENE="${GENES[$IDX]}"
CENTER_POS="${CENTER_POS[$IDX]}"
POS="${POS[$IDX]}"
ALT="${ALTS[$IDX]}"
mkdir -p "./${OUTDIR}/${CONDITION}"

python 1_viz_rnaseq_cov_ISM.py \
    --gene "$GENE" \
    --center_pos "$CENTER_POS" \
    --pos "$POS" \
    --alt "$ALT" \
    --condition "$CONDITION" \
    --seq_len 16384 \
    --num_folds 8 \
    --output_dir "./${OUTDIR}" 
