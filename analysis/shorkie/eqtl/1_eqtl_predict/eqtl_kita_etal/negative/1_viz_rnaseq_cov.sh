#!/bin/bash
# 
#SBATCH --time=48:00:00
#SBATCH -N 1
#SBATCH -n 8
#SBATCH --job-name=viz_ism_shorkie
#SBATCH --output=job_output_%A_%a.log
#SBATCH --mail-type=end
#SBATCH --mail-user=kuanhao.chao@gmail.com
#SBATCH --mem=12G
#SBATCH --array=0-700

GENES=("YBR192W" "YGL164C" "YEL075C" "tL(UAA)K" "YDR299W" "tN(GUU)L" "YLR304C" "YLR456W" "YAL067C" "YLR318W" "YGR058W" "YNL048W" "YGL004C" "YML089C" "YNL289W" "YDR226W" "YJR061W" "YDR069C" "YJR120W" "YFL016C" "YHR160C" "YKL138C-A" "YKL164C" "YJR056C" "YDL234C" "YJL193W" "YMR250W" "YER063W" "YLL008W" "YKL042W" "YDR242W" "YDR498C" "YGL079W" "YGR295C" "YIL136W" "YBL048W" "YLR307C-A" "YKL225W" "YDR487C" "YLR331C" "YGL092W" "YBL025W" "YLR315W" "YMR272W-B" "tE(UUC)M" "YHR013C" "YJL159W" "YBR027C" "YDR433W" "YMR247C" "tP(UGG)O3" "YJR061W" "YPL173W" "YER094C" "tI(AAU)G" "YMR294W" "YBL108C-A" "YHL042W" "YJR138W" "YOL162W" "YOR189W" "YDR487C" "YGL189C" "YJR103W" "YMR062C" "YOR071C" "YKL123W" "YHR043C" "YOR131C" "YLR031W" "YMR253C" "YFL016C" "YER153C" "YPL071C" "YPL232W" "YHL049C" "YDL024C" "YDR514C" "YER186C" "YNL266W" "YOR225W" "YLL015W" "YFR003C" "YPL231W" "YOL107W" "YGL261C" "YBR226C" "YKL066W" "YAR028W" "YHR136C" "YKL072W" "YER041W" "YNL019C" "YLR007W" "YLR225C" "YER003C" "YKL125W" "YHL029C" "YPL065W" "YIL127C" "YDR501W" "YIL115C" "YKR065C" "YMR150C" "YJR138W" "YFL052W" "YLR031W" "YML001W" "YDR085C" "YLR034C" "YKL221W" "YEL051W" "YER113C" "YML059C" "YMR005W" "YJL177W" "tS(GCU)O" "YCL022C" "YOR263C" "YKR040C" "YDR495C" "YOL166W-A" "YIL176C" "YDL193W" "YDL190C" "YDL128W" "YPL016W" "YLL012W" "YNR066C" "YKR043C" "YKR068C" "YIL161W" "YOL079W" "YMR272W-B" "YML111W" "YNL211C" "YKL208W" "YJR094C" "YDR500C" "YDR529C" "YPL132W" "YJL175W" "YLR010C" "YGR027C" "YLR146C" "YKL178C" "YLR094C" "YPL082C" "tT(AGU)B" "YHR114W" "YHL036W" "YLR457C" "tE(UUC)I" "YOR072W-A" "YPL200W" "YJR149W" "YDL172C" "YPR201W" "YJL041W" "YOL125W" "YNL245C" "YGR276C" "YLR108C" "YDR327W" "YDL124W" "YMR266W" "YFL021W" "YDL159C-B" "YER189W" "YPL066W" "YLR205C" "YNL110C" "YOL156W" "YIL039W" "YPR169W-A" "YER026C" "YCR107W" "YAL063C" "YNL054W-A" "YGL032C" "YNL329C" "YNL178W" "YDL200C" "YLR434C" "YDR419W" "YGL039W" "YBR255C-A" "YGL080W" "YOL156W" "YDR345C" "YHR148W" "YOR072W-B" "YNR072W" "YAL015C" "YOR325W" "YGL262W" "YHL010C" "YDR476C" "YKL058W" "YMR192W" "IRT1" "YIR002C" "YKR018C" "snR4" "YIL098C" "YIL093C" "YLL011W" "YFL048C" "YOL038C-A" "YJL199C" "YIL162W" "YMR279C" "YGL158W" "YPL244C" "YPR150W" "YGR113W" "YGL070C" "YER094C" "YOL026C" "YOL048C" "YDL140C" "YIR021W-A" "YBL013W" "YER188C-A" "YDR130C" "YLR026C" "YGR198W" "YLR200W" "YLR321C" "YNR065C" "YOL151W" "YBR257W" "tT(AGU)C" "YKL174C" "YCR079W" "YLR344W" "YMR152W" "YKR066C" "YEL077W-A" "YOR192C" "YIR010W" "YLR337C" "YMR304W" "YML024W" "YOL141W" "YOL032W" "YLL030C" "YGL059W" "YML130C" "YMR173W-A" "YKL054C" "YEL034W" "YAL063C" "YFL032W" "YLR234W" "YEL069C" "YDL055C" "YJL160C" "YCR054C" "YBR201C-A" "tS(AGA)D3" "YGL188C-A" "YLR455W" "YMR116C" "YHR021W-A" "YLR457C" "YGL194C-A" "YDR012W" "YJR045C" "YDL211C" "tK(CUU)G1" "YCR038W-A" "YHR092C" "YBR278W" "YJR127C" "YEL023C" "YJL054W" "YER056C" "YJR046W" "YDL045C" "YPR163C" "YLR256W" "YDL236W" "YCL075W" "YGR117C" "YJR080C" "YPR078C" "YPL078C" "YDR496C" "YLR452C" "YKL177W" "YHR180W" "YOL042W" "YMR247W-A" "YPR194C" "YIR038C" "YHR137W" "YLR338W" "YGL086W" "YMR271C" "YOR295W" "YBR007C" "YNL329C" "YJR104C" "YER009W" "YKL211C" "YBR293W" "YNL066W" "YLR439W" "YPL149W" "YOR192C-B" "YER063W" "YML116W-A" "YPL068C" "YNL263C" "YBL088C" "YKL218C" "YNL228W" "YMR131C" "YCR061W" "YER043C" "tK(CUU)C" "tY(GUA)J2" "YIL160C" "YDR498C" "YPL183C" "YNL018C" "YMR030W" "YJR140C" "YPR104C" "YDR522C" "YER058W" "YDR541C" "tT(AGU)I1" "YDL128W" "YAL031C" "YGR289C" "YLR264W" "YNL018C" "YKL194C" "YGR251W" "YCR038C" "YHL024W" "YGL033W" "YOL158C" "YNL292W" "YBR179C" "YMR247W-A" "YMR137C" "YPL022W" "YOR104W" "YPR167C" "YER024W" "YPL216W" "YNL320W" "YIL114C" "YOL154W" "tT(CGU)K" "YDL084W" "YGL054C" "YNL057W" "YDL119C" "YEL046C" "YNL195C" "YGL240W" "YLR044C" "YGL260W" "YOR345C" "YPL079W" "YOR381W" "YNL042W-B" "YJL133C-A" "YGL139W" "YIL158W" "YLR250W" "YNL144C" "YDR322C-A" "YPL281C" "YOL166C" "YCR015C" "YLR334C" "YGL191W" "YOR364W" "YKR061W" "YER137C" "YMR267W" "YCL017C" "YIL037C" "YJL189W" "YGR218W" "tK(CUU)G3" "YNL067W-A" "YOR104W" "YFL034W" "YOR027W" "YOR378W" "YMR125W" "YCL065W" "YML032C" "YFR024C-A" "YMR097C" "YJL099W" "YER184C" "YOR187W" "snR39" "YDL248W" "YDR161W" "snR86" "YJL077W-A" "IRT1" "YAL037W" "YLR436C" "YLL062C" "YGR174W-A" "YFL056C" "YER181C" "YGR034W" "YLR082C" "YNL292W" "YLR251W" "YDL119C" "YPR170W-A" "tD(GUC)L2" "YOR151C" "YOR018W" "YJR157W" "YCR077C" "YOR255W" "YML124C" "YKL100W-A" "YMR188C" "YDL024C" "YNR025C" "YPL279C" "YLR099W-A" "YJR136C" "YAR031W" "YDR371W" "YOL025W" "YDL028C" "YHR010W" "YIL120W" "YNL108C" "YLR340W" "tK(CUU)E2" "YLR401C" "YJR074W" "tS(GCU)F" "YLR426W" "YGR115C" "YNR034W" "YGR169C" "YMR026C" "YPL114W" "YMR173W" "YDR467C" "YDR162C" "YGL133W" "YGR012W" "YOR316C-A" "YPL245W" "YMR003W" "YOR346W" "YBR252W" "YLR319C" "YDL247W" "YOR034C" "YDR239C" "YKL220C" "YNL241C" "YOR215C" "YFR017C" "YAL053W" "YEL038W" "YLR431C" "YDR233C" "YNR073C" "YNL214W" "YHL033C" "YMR123W" "YIL085C" "YBR213W" "YHR112C" "YLR236C" "YBL055C" "YDR016C" "YKL103C" "YGL010W" "YBL027W" "YGR287C" "YMR092C" "YBR048W" "ICR1" "YDL228C" "YLR214W" "YDR135C" "YNR061C" "YBL006W-A" "YOR236W" "YML131W" "YLR125W" "YCR072C" "YHR062C" "YGR169C" "YNL326C" "YGL045W" "YDR075W" "YGL204C" "YOL004W" "tL(GAG)G" "YJL144W" "YGR249W" "YLR008C" "YDL225W" "YGR093W" "YBR171W" "YGL005C" "YOR327C" "YMR291W" "YDR167W" "YGL096W" "YNR059W" "YPL079W" "YER130C" "YHL008C" "YJR015W" "tV(AAC)G2" "YDL127W" "YCR088W" "YMR169C" "YJL218W" "snR3" "YHR079C-A" "YLR395C" "YMR290C" "YJR073C" "tP(UGG)O3" "YPL170W" "YAR007C" "tS(GCU)F" "YOR310C" "YDL243C" "YNL156C" "YOR158W" "tD(GUC)J4" "snR41" "YNL121C" "YML113W" "YFL049W" "YBL030C" "YOL117W" "YOL068C" "YKL224C" "YHR162W" "YNL102W" "YLR117C" "YLL004W" "YJL164C" "YMR250W" "YER119C" "YDL200C" "YDR219C" "YKR090W" "tL(UAA)J" "YNR037C" "YCL027W" "YPR007C" "YDR065W" "YMR265C" "YLR056W" "YOR161C-C" "YJR133W" "YML006C" "YDL227C" "tQ(UUG)D2" "YDL119C" "tS(AGA)G" "YIL174W" "YHR177W" "YNL148C" "snR83" "tA(AGC)F" "YGL165C" "YLR187W" "YIL137C" "YPL242C" "snR50" "YML103C" "YOR149C" "YJL138C" "YKL033W-A" "YMR272W-A" "YIL038C" "YOL029C" "YHR019C" "YGR034W" "YDR544C" "YNL233W" "YNL301C" "YMR193W" "YOR165W" "YLR137W" "YBR296C-A" "YNR072W" "YER187W" "YJR129C" "YEL055C" "YML126C" "YLL061W" "YCR075W-A" "YLL004W" "YER156C" "YLR402W")
CENTER_POS=(607602 192875 6303 84259 1059459 975647 737869 1054333 9958 766489 604495 537549 492059 91485 85777 916446 551032 588386 646873 103848 420065 185704 143068 542637 36367 71449 770337 281645 131705 359142 943632 1447216 358537 1082599 93433 127620 745826 1115 1429599 791350 337619 170320 763742 810085 290765 130524 120011 294937 1331503 767200 979898 550676 222956 348780 737862 858065 7141 15239 684307 8604 689920 1429008 150162 620737 396483 461660 213360 191370 573228 205361 777923 106494 475496 420632 107304 4896 410375 1473027 563010 144020 761905 116686 152981 108114 111851 7193 674295 315072 185126 375221 299674 234744 599321 163466 588604 159286 208258 49420 427708 117413 1451166 148892 566044 562698 685904 27960 203834 266878 615975 212081 5676 59504 390667 158654 275822 89149 274962 82143 819302 516535 1440976 701 8025 115328 121469 232783 521100 125226 754667 522995 570688 38500 181326 811472 46676 250008 46461 605976 1450699 1496792 301533 94198 169862 534830 435960 115293 328498 404629 266622 337824 26177 1056760 372678 460514 171671 707333 150505 939832 366400 84529 186964 1045214 366560 1125103 240282 798298 96802 173380 568407 427414 554133 418690 25443 278371 882932 211419 312594 29070 518686 437336 21949 301290 101118 1007532 1302821 424065 728435 360441 25152 1163440 394959 465319 772160 128423 923131 5092 83781 1411649 331388 647456 607458 360959 476390 425446 180565 190373 129999 40564 254919 60979 37592 826416 206685 87536 831154 718859 374582 349817 275863 241442 210795 398583 202766 570041 716510 196991 895006 548709 777907 750706 43599 728932 295867 120989 252345 819681 563134 569245 542 703324 375279 804081 874114 226649 56640 266130 79747 389105 15705 610968 337857 86575 27822 75463 610616 21705 356541 119045 220477 624076 1306013 149107 1053367 500943 148456 1056900 140188 471061 524334 80843 121994 198596 290390 761051 662418 109718 333485 267391 523577 372671 868942 646878 32090 2422 727267 582415 698374 408975 1443484 1041713 115293 465080 249954 769493 928517 425829 375511 804081 344550 806533 867542 248671 19855 623191 172034 37530 784913 500312 1015184 272321 709346 281802 37647 425055 148166 59383 19537 220548 533975 226774 235505 150129 544304 38676 1449089 204653 601195 331508 694428 733692 1488306 271760 1521834 175167 232831 86648 1076847 673354 601790 78797 994786 201185 55934 436038 21630 83393 589394 769211 544581 506265 517647 877070 200350 143517 37528 150030 33003 44573 303504 402738 515474 247666 70113 272669 47565 234147 4590 982448 406317 1055829 547200 160321 245764 49143 641481 355791 1113284 11742 594 142629 796814 143828 1023944 558133 441963 801226 93512 285554 76178 931461 876152 501440 515034 63396 382459 1049750 516489 14003 212859 202770 459508 239123 561510 684078 365333 1909 779427 762993 294584 607750 73860 1011268 17262 846611 16490 551377 555542 291480 85056 642476 249508 882949 795247 616666 363397 730773 251945 807956 24474 253845 636750 410155 673326 15105 341678 678503 186605 1218991 275073 403331 126572 134890 418818 805786 434528 924245 575876 191439 986803 722053 690239 836056 325046 334207 609618 1397754 780987 257334 511436 907847 85993 272746 981571 725438 769312 5408 397645 943132 12343 199244 745698 181248 44675 81181 1001278 930059 776214 245895 36040 513448 201914 650463 335951 613200 116704 478660 246068 475763 168731 1068743 453550 332992 396505 46115 570009 728296 742767 215181 780732 9755 393266 242723 223942 835241 28026 414872 596817 112033 317329 703454 146319 988087 166463 50657 670287 578933 490750 930131 851620 789102 323170 736429 406902 422511 94382 462733 823611 235479 265059 601700 23308 661920 262610 910020 851984 572117 982641 228661 156676 191937 898841 18404 342049 632397 541170 719918 400342 43166 36394 164147 98735 205106 1118 422957 431058 384661 140300 108067 768463 403054 102484 906124 608679 424406 692150 70425 571582 580899 797644 252833 639401 672728 257856 46848 643844 247813 561585 8262 457553 351608 626195 205164 192234 524814 94089 95212 261263 67962 611617 154467 374399 810085 283278 270370 142863 556169 1525351 212140 64081 649387 644536 418481 799566 772834 566139 664330 51707 20392 18156 249290 138154 484534 922706)
POS=(607602 192875 6303 84259 1059459 975647 737869 1054333 9958 766489 604495 537549 492059 91485 85777 916446 551032 588386 646873 103848 420065 185704 143068 542637 36367 71449 770337 281645 131705 359142 943632 1447216 358537 1082599 93433 127620 745826 1115 1429599 791350 337619 170320 763742 810085 290765 130524 120011 294937 1331503 767200 979898 550676 222956 348780 737862 858065 7141 15239 684307 8604 689920 1429008 150162 620737 396483 461660 213360 191370 573228 205361 777923 106494 475496 420632 107304 4896 410375 1473027 563010 144020 761905 116686 152981 108114 111851 7193 674295 315072 185126 375221 299674 234744 599321 163466 588604 159286 208258 49420 427708 117413 1451166 148892 566044 562698 685904 27960 203834 266878 615975 212081 5676 59504 390667 158654 275822 89149 274962 82143 819302 516535 1440976 701 8025 115328 121469 232783 521100 125226 754667 522995 570688 38500 181326 811472 46676 250008 46461 605976 1450699 1496792 301533 94198 169862 534830 435960 115293 328498 404629 266622 337824 26177 1056760 372678 460514 171671 707333 150505 939832 366400 84529 186964 1045214 366560 1125103 240282 798298 96802 173380 568407 427414 554133 418690 25443 278371 882932 211419 312594 29070 518686 437336 21949 301290 101118 1007532 1302821 424065 728435 360441 25152 1163440 394959 465319 772160 128423 923131 5092 83781 1411649 331388 647456 607458 360959 476390 425446 180565 190373 129999 40564 254919 60979 37592 826416 206685 87536 831154 718859 374582 349817 275863 241442 210795 398583 202766 570041 716510 196991 895006 548709 777907 750706 43599 728932 295867 120989 252345 819681 563134 569245 542 703324 375279 804081 874114 226649 56640 266130 79747 389105 15705 610968 337857 86575 27822 75463 610616 21705 356541 119045 220477 624076 1306013 149107 1053367 500943 148456 1056900 140188 471061 524334 80843 121994 198596 290390 761051 662418 109718 333485 267391 523577 372671 868942 646878 32090 2422 727267 582415 698374 408975 1443484 1041713 115293 465080 249954 769493 928517 425829 375511 804081 344550 806533 867542 248671 19855 623191 172034 37530 784913 500312 1015184 272321 709346 281802 37647 425055 148166 59383 19537 220548 533975 226774 235505 150129 544304 38676 1449089 204653 601195 331508 694428 733692 1488306 271760 1521834 175167 232831 86648 1076847 673354 601790 78797 994786 201185 55934 436038 21630 83393 589394 769211 544581 506265 517647 877070 200350 143517 37528 150030 33003 44573 303504 402738 515474 247666 70113 272669 47565 234147 4590 982448 406317 1055829 547200 160321 245764 49143 641481 355791 1113284 11742 594 142629 796814 143828 1023944 558133 441963 801226 93512 285554 76178 931461 876152 501440 515034 63396 382459 1049750 516489 14003 212859 202770 459508 239123 561510 684078 365333 1909 779427 762993 294584 607750 73860 1011268 17262 846611 16490 551377 555542 291480 85056 642476 249508 882949 795247 616666 363397 730773 251945 807956 24474 253845 636750 410155 673326 15105 341678 678503 186605 1218991 275073 403331 126572 134890 418818 805786 434528 924245 575876 191439 986803 722053 690239 836056 325046 334207 609618 1397754 780987 257334 511436 907847 85993 272746 981571 725438 769312 5408 397645 943132 12343 199244 745698 181248 44675 81181 1001278 930059 776214 245895 36040 513448 201914 650463 335951 613200 116704 478660 246068 475763 168731 1068743 453550 332992 396505 46115 570009 728296 742767 215181 780732 9755 393266 242723 223942 835241 28026 414872 596817 112033 317329 703454 146319 988087 166463 50657 670287 578933 490750 930131 851620 789102 323170 736429 406902 422511 94382 462733 823611 235479 265059 601700 23308 661920 262610 910020 851984 572117 982641 228661 156676 191937 898841 18404 342049 632397 541170 719918 400342 43166 36394 164147 98735 205106 1118 422957 431058 384661 140300 108067 768463 403054 102484 906124 608679 424406 692150 70425 571582 580899 797644 252833 639401 672728 257856 46848 643844 247813 561585 8262 457553 351608 626195 205164 192234 524814 94089 95212 261263 67962 611617 154467 374399 810085 283278 270370 142863 556169 1525351 212140 64081 649387 644536 418481 799566 772834 566139 664330 51707 20392 18156 249290 138154 484534 922706)
ALTS=(T G A C C A A G G A G T A A C C A G A T G G G A A A C T G C T G T G T G A A A T T C T A A C A G A A A A G A T T G G C C A G A G C C G C C C C G C C G A C G A A T C T T T G A G A C T T G C G A C C A G G T G G C G C A T A C A C A T T T T C A A T T C A A C A T A C G G A A A G G C A T G A A A C T A C G T C A C T T T T C A T T C A C G A T G A T T A A A C C T A C C C T G T A A C C A A A G A C A T A G G T T G A A T G T T A T C C T C G C G T G T C A T G C C T T T T T C C A G C T C G A G G C A T C A A T C C C T T T G T C C T C G C G A T C G G C T G A G A T G A T C A A G A A T A A G C C A C G T T G C T G G A G G A T C C C T C A C C T G G C C T C A C C T G A A T A A G T C G C G T T T A G T T C A T T A T G T T G T A G A A T C C T C G G T A T T C G A C C G T A C C A T A C A G G C T C T A C G G A T C T C T G C C G A G T T C A T G C A G G G G G A T A G T A G T A G G T T A T G G C G C T G G A C T A A C G T A G C G T A G A C C G C A T G G C C C A A G T C G C C T T A G A C A A G G G T G T A A G T A A T T T T T T T C T T C G G C A G C T C A A C T G T G T G A C A A G G A A G T G C C C A T T A C C G A T T A G G G A C A T G G A T T T T G C G A T A C C A G C T A A A C T A C C C A C G G A T C G A G C A G G C T C C C T G A A T T A)

CONDITION="test_1"
OUTDIR="results"

# Pick the ith entry based on SLURM_ARRAY_TASK_ID
IDX=$SLURM_ARRAY_TASK_ID
GENE="${GENES[$IDX]}"
CENTER_POS="${CENTER_POS[$IDX]}"
POS="${POS[$IDX]}"
ALT="${ALTS[$IDX]}"
mkdir -p "./${OUTDIR}/${CONDITION}"

python 1_viz_rnaseq_cov_ISM.py \
    --gene "$GENE" \
    --center_pos "$CENTER_POS" \
    --pos "$POS" \
    --alt "$ALT" \
    --condition "$CONDITION" \
    --seq_len 16384 \
    --num_folds 8 \
    --output_dir "./${OUTDIR}" 
